{"remainingRequest":"/Users/Jiama003/Desktop/dist/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/Jiama003/Desktop/dist/src/components/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/Jiama003/Desktop/dist/src/components/index.vue","mtime":1559733147417},{"path":"/Users/Jiama003/Desktop/dist/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/Jiama003/Desktop/dist/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/Jiama003/Desktop/dist/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/Jiama003/Desktop/dist/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n// import Cmap from '@/assets/js/Map'\nimport {MP} from '@/assets/js/Map.js'\nimport {mapState} from 'vuex'\nimport * as types from '@/store/mutation-types'\nimport Api from '../assets/js/api'\nimport axios from 'axios'\nimport utils from '../assets/js/utils'\nexport default {\n  beforeRouteEnter (to, from, next) {\n    console.log(to.path)\n    let url = window.location.href.split('?')[1] || \"\"\n    //获取url参数 存到session\n    if(url&&url!==\"\"){\n      url.split('&').forEach(item=>{\n        let query = item.split('=')\n        sessionStorage.setItem(query[0],query[1])\n      })\n    }\n    next()\n  },\n  created(){\n    //socket  token\n    let _this = this\n    let timeStamp = Date.parse(new Date()) / 1000\n    //获得当前验签\n    function getSign(){\n        let util =   utils.gainPhone({\n            appKey: '7863228592',\n            timestamp: timeStamp,\n            accessToken:sessionStorage.getItem('accessToken'),\n            accountID:sessionStorage.getItem('accountID'),\n            })\n        return util\n    }\n    //添加头部\n    let headers = {\n      appKey: '7863228592',\n      timestamp: timeStamp,\n      accessToken:sessionStorage.getItem('accessToken'),\n      accountID:sessionStorage.getItem('accountID'),\n      sign: getSign()\n    }\n    //刷新msgtoken 并且开启长连接\n    axios({\n        url:'/invokMessage/account/refreshMsgToken',\n        method:'POST',\n        headers:headers,\n        data:{accountID:sessionStorage.getItem('accountID')}\n      }).then(res=>{\n        console.log(res)\n        _this.msgToken = res.data.RESULT.msgToken\n        initWebSocket()\n        function initWebSocket(){\n        //初始化websocket\n        //建立连接\n        _this.websocket = new WebSocket('wss://im-msg-weixin.jiama.online/wss')\n        //建立成功\n        _this.websocket.onopen = function (){ //连接成功事件\n        console.log('websocket success')\n          _this.websocket.send (JSON.stringify ({\n                opt: \"connect\",\n                accountID: _this.accountID,\n                msgToken: _this.msgToken,\n                timestamp: 1559568992,\n                lat: 31.01, //登陆时纬度\n                lon: 121.01 //登陆时经度\n          }))\n        // this.start()\n        }\n        //建立失败\n          _this.websocket.onerror = function(){ //连接失败事件\n          console.log(\"WebSocket连接发生错误\");\n          //  this.reconnect();\n          }\n          //接受信息\n          _this.websocket.onmessage = function (event){ //接收服务器推送的信息\n            //打印收到的服务器内容\n            let data = JSON.parse(event.data)\n            console.log(data)\n              start()\n            let List = []\n            List.push(data)\n            _this.updataPushMapOverview(List)\n            console.log(List)\n            _this.createTagMessage('欢迎登陆')\n            //收到服务器信息，心跳充值\n            // reset()\n          }\n        //连接关闭\n          _this.websocket.onclose = function (e){\n          console.log(e)\n          clearTimeout(_this.timeoutObj)\n          console.log(\"connection closed (\" + e.code + \")\");\n          //重连\n          // this.reconnect()\n          }\n      }\n      function reconnect(){//重新连接\n          if(_this.lockReconnect){\n            return\n          }\n          _this.lockReconnect = true\n          //如果没有连上会一直重连，设置延迟避免请求过多\n          _this.timeoutnum && clearTimeout(_this.timeoutnum);\n          _this.timeoutnum = setTimeout(function(){\n            //新连接\n            // that.initWebSocket();\n            _this.lockReconnect = false\n          },false)\n        }\n        function start(){//开启心跳\n        console.log('start  go')\n        let time = 0\n          _this.timeoutObj = setInterval(function(){\n            console.log(time+1)\n            //这里发送一个心跳，后端收到后，返回一个心跳消息\n            let timeStamps = Date.parse (new Date ()) / 1000;\n              _this.websocket.send(JSON.stringify ({\n                opt: 'heart',\n                accountID: _this.accountID,\n                msgToken: _this.msgToken,\n                timestamp: timeStamps,\n                isKF: 1,\n                gps: [{\n                  E: 121.30692,\n                  N: 31.16184,\n                  V: 0,\n                  D: - 1,\n                  A: 13,\n                  T: timeStamps\n                }]\n              }));\n          },10000)\n        }\n    }).catch(err=>{\n      console.log(err)\n    })\n    if(!sessionStorage.getItem(\"accountID\")){\n        this.$router.push('/login')\n    }\n    //获取个人信息\n    this.$store.dispatch(types.GET_KF_INFO,this.accountID)\n    .then(res=>{\n      this.userInfo = res\n    }).catch(err=>console.log(err))\n        console.log(this.userInfo)\n    //获取服务单列表\n    this.ListData0 = {\n      \"status\":\"0\",\n      \"accountID\":this.accountID\n    }\n     this.ListData1 ={\n        \"status\":\"1\",\n        \"accountID\":this.accountID\n    }\n    this.ListData2 ={\n        \"status\":\"2\",\n        \"accountID\":this.accountID\n    }\n    //获取地图上未被接单的列表\n    this.getPushListOrder(this.ListData0)\n    //获取已接单列表\n    this.getListOrder(this.ListData1)\n    //获取结束单列表\n    this.getEndOrderList(this.ListData2)\n  },\n  name: 'index',\n  props: {\n    msg: String\n  },\n  data() {\n    return {\n      errorImgSrc: 'this.src=\"' + require('../assets/ServiceLogo.png') + '\"',\n      orderhelp:require('../assets/orderhelp.jpg'),\n      orderSOS:require('../assets/orderSOS.jpg'),\n      currentO_id:\"\",\n      //客服个人信息\n      userInfo:{},\n      //工单推送信息\n      userPointLocationOrderInfo:[],\n      //右侧已推送工单列表\n      innerLeftList:[],\n      //获取左侧列表\n      ListData0:{},\n      ListData1:{},\n      ListData2 :{},\n      accountID:sessionStorage.getItem('accountID'),\n      accessToken:sessionStorage.getItem('accessToken'),\n      //右边长连接消息详情\n      innerRightMessageInfo:[],\n      //右边成员列表\n      innerRightOrderMember:[],\n      //当前服务\n      currentServiceNum:0,\n      currentService:\"当前服务(0)\",\n      //已结束服务单列表\n      endOrderList:[],\n      dialogVisibleTransfer:false,\n      edit:0,//是否编辑\n      inputEndOrderAdress:\"上海市-普陀区-镇坪路389号\",\n      textareaEndOrderDesc:\"请描述用户所咨询的问题\",\n      status: \"1\",\n      socketMessageText:\"\",\n      index:Number,\n      endindex:Number,\n      leftListActive:\"\",\n      visible2: false,\n      visible3: false,\n      innerRightVisible:false,\n      dialogVisibleOff:false,\n      dialogVisiblereadyOff:false,\n      dialogVisibleConfirm:false,\n      dialogVisibleEndOrder:false,\n      ak: 'G1ZqRQeFuAutcV5NYPiVvdaMNQ5tWpp9',\n      currentServiceInfo:{},//当前服务信息,\n      map:{},//地图\n      BMap:{},\n      Overlay:{},\n      Point:{},\n     // socket 部分\n     msgToken:'',\n     websocket:null,//建立的连接\n     lockReconnect:false,\n     timeout:2*1000,//30秒一次的心跳\n     timeoutObj:null,//心跳倒计时\n     serverTimeoutObj:null,//心跳倒计时\n     timeoutnum:null,//断开 重连倒计时\n     lastRunTime:Date.now(),//上次播放的时间\n    }\n  },\n\n  mounted(){\n    //渲染地图\n   var _this = this;\n    MP(_this.ak).then(BMap => {\n      //在此调用api\n      _this.BMap = BMap\n      _this.Overlay = new BMap.Overlay()\n      _this.map = new _this.BMap.Map(\"container\");    // \n      _this.map.centerAndZoom(new _this.BMap.Point(116.404, 39.915), 11);\n      // 创建初始点 目前是北京 应根据客服所选城市  只推客服所选城市里的orderlist\n      let userPoint = new _this.BMap.Point(116.328, 40.020)\n      //创建初始覆盖物\n      //开启滚轮缩放\n\n      _this.map.enableScrollWheelZoom(true);\n      // 添加平移缩放\n      // map.addControl(new BMap.NavigationControl({anchor: BMAP_ANCHOR_BOTTOM_LEFT}));\n      // 添加比例尺\n      _this.map.addControl(new _this.BMap.ScaleControl());\n      _this.map.centerAndZoom(userPoint,15);\n      // 添加缩略地图\n      console.log(_this.BMap)\n      _this.map.addControl(new _this.BMap.OverviewMapControl());\n    }).then(res=>{\n        _this.getPushListOrder(_this.ListData0)\n    })\n  },\n  methods:{\n    //第一次加载页面刷新覆盖物\n    updataMapOverview(list){\n      var _this = this;\n      let BMap = _this.BMap\n      console.log(_this.map)\n          //循环遍历增加页面推送工单\n          //创建页面自定义覆盖物原型方法\n          function picOverlay(point,data){\n            this._point = point;\n            this.data = data\n          }\n          \n          picOverlay.prototype = _this.Overlay\n          picOverlay.prototype.initialize = function(map){\n            this._map = map\n            let div = this._div = document.createElement('div');\n            div.style.position = 'absolute'\n            div.style.overflow = 'hidden'\n            div.style.fontSize = '12px'\n            div.style.textAlign = 'center'\n            div.style.cursor = 'pointer'\n            div.style.zIndex = BMap.Overlay.getZIndex(this._point.lat);\n            let p = this._p = document.createElement('p')\n            let img = this._img = document.createElement('img')\n            let tipImg = this._tipImg = document.createElement('img')\n            p.appendChild(document.createTextNode(this.data.nickName))\n            img.setAttribute('src',this.data.headPic)\n            tipImg.setAttribute('src',_this.orderhelp)\n            //设置图片样式\n            img.style.width ='30px'\n            img.style.height ='30px'\n            img.style.border = '2px solid #005ced'\n            img.style.boxShadow = '0px 0px 8px #005ced'\n            img.style.borderRadius = '50px'\n            //设置tip图片样式\n            tipImg.style.width ='118px'\n            tipImg.style.height ='65px'\n\n            div.appendChild(tipImg)\n            div.appendChild(img)\n            div.appendChild(p)\n            //增加点击事件创建服务单\n            let data = this.data\n            //抢单事件\n            div.onclick = function(e){\n                //客服抢单时获取用户信息\n                console.log(data)\n                console.log(_this.accountID)\n                let QD_Data = {\n                  \"orderID\" : data.orderID,\n                  \"accountID\" : _this.accountID\n                }\n                _this.$store.dispatch(types.UPDATE_ORDER,QD_Data).then(res=>{\n                 _this.openSuccess('抢单成功')\n                _this.getListOrder(_this.ListData1)\n                  div.remove(div)\n                // let info = {\n                //   \"accountID\":_this.accountID,\n                //   \"nickName\":_this.userInfo.user_name,\n                //   \"headPic\":'https://jma.oss-cn-hangzhou.aliyuncs.com/headers/default-boy.jpg',\n                //   \"lng\": data.lng,\n                //   \"lat\": data.lat,\n                //   \"userType\":\"2\",\n                //   \"channelID\":data.channelID,\n                //   \"orderID\":data.o_id\n                // }\n                //点击抢单时客服加入频道\n                // _this.$store.dispatch(types.JOIN_CHANNEL,info).then(res=>{\n                 \n                //   console.log('频道加入成功')\n                //   console.log(res)\n                // }).catch(err=>{\n                //   console.log(err)\n                //   _this.openError('抢单失败')\n                // })\n              }).catch(err=>{\n                console.log(err)\n                _this.openError('抢单失败')\n              })\n              //获取正在服务服务单列表\n            }\n            _this.map.getPanes().labelPane.appendChild(div);\n              return div\n            }\n            picOverlay.prototype.draw = function(){\n              let map = this._map;\n              let pixel = map.pointToOverlayPixel(this._point)\n              this._div.style.left = pixel.x + \"px\";\n              this._div.style.top  = pixel.y - 30 + \"px\";\n            }\n          //遍历用户\n\n          if(list&&list[0]&&list.length>=1){\n              for (let it of list) {\n                let location =  {lng:it.lng,lat:it.lat}\n                let myOverlay = new picOverlay(location,it)\n                _this.map.addOverlay(myOverlay)\n            }\n\n          }\n\n    },\n    // 增加 / 更新 / 刷新页面 覆盖物\n    updataPushMapOverview(list){\n      var _this = this;\n      let BMap = _this.BMap\n      console.log(BMap)\n          //循环遍历增加页面推送工单\n          //创建页面自定义覆盖物原型方法\n          function picOverlay(point,data){\n            this._point = point;\n            this.data = data\n          }\n          picOverlay.prototype = _this.Overlay\n          picOverlay.prototype.initialize = function(map){\n            this._map = map\n            let div = this._div = document.createElement('div');\n            div.style.position = 'absolute'\n            div.style.overflow = 'hidden'\n            div.style.fontSize = '12px'\n            div.style.textAlign = 'center'\n            div.style.cursor = 'pointer'\n            div.style.zIndex = BMap.Overlay.getZIndex(this._point.lat);\n            let p = this._p = document.createElement('p')\n            let img = this._img = document.createElement('img')\n            let tipImg = this._tipImg = document.createElement('img')\n            p.appendChild(document.createTextNode(this.data.msgObj.nickName))\n            img.setAttribute('src',this.data.msgObj.headPic)\n            tipImg.setAttribute('src',_this.orderhelp)\n            //设置图片样式\n            img.style.width ='30px'\n            img.style.height ='30px'\n            img.style.border = '2px solid #005ced'\n            img.style.boxShadow = '0px 0px 8px #005ced'\n            img.style.borderRadius = '50px'\n            //设置tip图片样式\n            tipImg.style.width ='118px'\n            tipImg.style.height ='65px'\n\n            div.appendChild(tipImg)\n            div.appendChild(img)\n            div.appendChild(p)\n            //增加点击事件创建服务单\n            let data = this.data\n            //抢单事件\n            div.onclick = function(e){\n                //客服抢单时获取用户信息\n                console.log(data)\n                console.log(_this.accountID)\n                let QD_Data = {\n                  \"orderID\" : data.orderID,\n                  \"accountID\" : _this.accountID\n                }\n                _this.$store.dispatch(types.UPDATE_ORDER,QD_Data).then(res=>{\n                 _this.openSuccess('抢单成功')\n                _this.getListOrder(_this.ListData1)\n                  div.remove(div)\n                // let info = {\n                //   \"accountID\":_this.accountID,\n                //   \"nickName\":_this.userInfo.user_name,\n                //   \"headPic\":'https://jma.oss-cn-hangzhou.aliyuncs.com/headers/default-boy.jpg',\n                //   \"lng\": data.lng,\n                //   \"lat\": data.lat,\n                //   \"userType\":\"2\",\n                //   \"channelID\":data.channelID,\n                //   \"orderID\":data.o_id\n                // }\n                //点击抢单时客服加入频道\n                // _this.$store.dispatch(types.JOIN_CHANNEL,info).then(res=>{\n                 \n                //   console.log('频道加入成功')\n                //   console.log(res)\n                // }).catch(err=>{\n                //   console.log(err)\n                //   _this.openError('抢单失败')\n                // })\n              }).catch(err=>{\n                console.log(err)\n                _this.openError('抢单失败')\n              })\n              //获取正在服务服务单列表\n            }\n            _this.map.getPanes().labelPane.appendChild(div);\n              return div\n            }\n            picOverlay.prototype.draw = function(){\n              let map = this._map;\n              let pixel = map.pointToOverlayPixel(this._point)\n              this._div.style.left = pixel.x + \"px\";\n              this._div.style.top  = pixel.y - 30 + \"px\";\n            }\n          //遍历用户\n          console.log(list)\n          if(list&&list[0].msgObj&&list.length>=1){\n              for (let it of list) {\n                let location = {lng:it.msgObj.lng,lat:it.msgObj.lat}\n                let myOverlay = new picOverlay(location,it)\n                _this.map.addOverlay(myOverlay)\n            }\n\n          }\n\n    },\n    getPushListOrder(data){ //推送服务单列表\n      let _this = this\n      this.$store.dispatch(types.LIST_PUSH_ORDER,data)\n      .then(res=>{\n          if(res.status==\"error\"){\n            _this.endOrderList = []\n          }else{\n            _this.userPointLocationOrderInfo = res\n            _this.updataMapOverview(_this.userPointLocationOrderInfo)\n            console.log(_this.userPointLocationOrderInfo)\n          }\n      }).catch(err=>{\n        console.log(err)\n      })\n    },\n    getEndOrderList(data){ //已结束服务单列表\n      console.log(123)\n      let _this = this\n      this.$store.dispatch(types.LIST_ORDER,data)\n      .then(res=>{\n          if(res.status==\"error\"){\n            _this.endOrderList = []\n          }else{\n            _this.endOrderList = res\n          }\n      }).catch(err=>{\n        console.log(err)\n      })\n    },\n    //消息列表滚动条事件\n    handleScroll(){\n      let scroll = document.getElementById('socketMessageList')\n      let height = document.getElementById('socketMessageListUl').offsetHeight\n      scroll.scrollTop = scroll.scrollHeight\n    },\n    //获取服务单列表\n    getListOrder(data){\n      let _this = this\n      this.$store.dispatch(types.LIST_ORDER,data)\n      .then(res=>{\n            //获取还未被抢单的列表\n            if(data.status==\"0\"){\n              console.log(res)\n              _this.userPointLocationOrderInfo = res\n            //获取已经被抢单的列表\n            }else if(data.status==\"1\"){\n              console.log(res)\n              if(res.status==\"error\"){\n                _this.innerLeftList = []\n              }else{\n                _this.innerLeftList = res\n                _this.currentServiceNum = _this.innerLeftList.length\n              }\n            }\n      }).catch(err=>{\n        console.log(err)\n      })\n    },\n    //客服加入频道\n    joinChannel(info){\n      this.$store.dispatch(types.JOIN_CHANNEL,info).then(res=>{\n        console.log('joinChannel')\n        console.log(res)\n      }).catch(err=>{\n        console.log(err)\n      })\n    },\n    //获取右侧消息详情\n    getMessageInfo(item,index){\n      let _that = this\n      this.currentServiceInfo = item\n      //创建并且初始化聊天窗口\n      this.index = index\n      _that.innerRightOrderMember = []\n      this.innerRightVisible = true\n      let data = {\n        \"orderID\":item.orderID,\n        \"accountID\": item.accountID,// 登录用户id\n        \"isInit\":\"1\"\n      }\n      //建立长连接\n      // this.initWebSocket()\n        _that.$store.dispatch(types.INIT_ORDER,data)\n        .then(res=>{\n          _that.innerRightOrderMember = res\n          console.log(res)\n        }).catch(err=>{\n          console.log(err)\n        })\n      console.log(item)\n      //获取聊天记录\n      _that.$store.dispatch(types.GET_CHAT_LOG,item.channelID)\n      .then(res=>{\n        console.log(res)\n      }).catch(err=>{\n        console.log(err)\n      })\n      _that.innerRightMessageInfo = []\n\n\n    },\n    //获取右侧已结束消息详情\n    getEndMessageInfo(item,index){\n      let _that = this\n      //创建并且初始化聊天窗口\n      _that.endindex = index\n      _that.innerRightOrderMember = []\n      _that.innerRightVisible = true\n      \n        _that.$store.dispatch(types.INIT_ORDER,item.orderID)\n        .then(res=>{\n          _that.innerRightOrderMember = res\n          console.log(res)\n        }).catch(err=>{\n          console.log(err)\n        })\n\n      //获取聊天记录\n      _that.$store.dispatch(types.GET_CHAT_LOG)\n      .then(res=>{\n        console.log(res)\n      }).catch(err=>{\n        console.log(err)\n      })\n      _that.innerRightMessageInfo = []\n\n\n    },\n    //长连接消息推送部分\n    createTagMessage(message){\n      // let UI = document.getElementById('socketMessageListUl')\n      // let p  = document.createElement('p')\n      // p.className = 'createTagP'\n      // p.appendChild(document.createTextNode(message))\n      // UI.appendChild(p)\n    },\n    websocketsend(msg){ //向服务器发送消息\n          //数据发送\n          let _this = this\n          console.log(msg)\n          this.socketMessageText = \"\"\n          this.websocket.send(msg)\n          setTimeout(()=>{\n            _this.handleScroll()\n          },0)\n    },\n    \n    EndOrder(){\n         let info = this.currentServiceInfo.o_id\n         let _this = this\n         console.log(info)\n        this.$store.dispatch(types.END_ORDER,info).then(res=>{\n          this.openSuccess('结单成功')\n          _this.innerLeftList =  _this.innerLeftList.filter((val)=>{\n             return val.o_id != info\n          })\n          _this.endOrderList.push(this.currentServiceInfo)\n          _this.currentServiceNum = _this.innerLeftList.length\n        }).catch(err=>{\n          console.log(err)\n          this.openError('结单失败')\n        })\n        _this.currentServiceNum = _this.innerLeftList.length\n        this.dialogVisibleEndOrder=false\n        this.innerRightVisible = false\n        \n    },\n    //错误提示\n    openError(err) {\n        this.$message.error(err);\n    },\n    //成功提示\n    openSuccess(success) {\n        this.$message({\n          message:success,\n          type:'success'\n        })\n    },\n    dialogOff(){\n      this.$confirm('确认关闭？')\n          .then(_ => {\n            done();\n          })\n          .catch(_ => {});\n    },\n    dialogreadyOff(){\n        this.$confirm('确认关闭？')\n          .then(_ => {\n            done();\n          })\n          .catch(_ => {});\n    },\n    dialogConfirm(){\n      this.$confirm('确认关闭？')\n          .then(_ => {\n            done();\n          })\n          .catch(_ => {});\n    },\n  //聊天样式绑定 自己的和他人的\n    messageStyle(i=0,style=0){\n      if(i===0){\n        if(style==0){\n          return `message-item-self`\n        }else if(style==1){\n          return `card1-self`\n        }\n      }else if(i===1){\n        if(style==0){\n          return `message-item`\n        }else if(style==1){\n          return `card1`\n        }\n      }\n    }\n\n  },\n  filters:{\n    timeFormat:function(v){\n       let time = Date.parse(new Date())\n      let diff = (time/1000)-v \n      let t = new Date(v*1000) //86400 504780\n      if(diff<300&&diff>60){\n       return parseInt(diff/60)+'分钟前'\n      }else{\n        return  t.toLocaleString()\n      }\n    }\n  },\n  computed:{\n    // ...mapState({\n    //   userinfo:state=>state.userinfo.mySelfInfo.accountID\n    // })\n  },\n  watch:{\n    currentServiceNum:function(v){\n      this.currentService=\"当前服务(\"+v+\")\"\n    },\n    innerLeftList:function(v){\n    }\n  }\n}\n",{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8RA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"main\">\n    <!-- 导航开始 -->\n    <div class=\"nav-bar\">\n      <div class=\"nav-left\">\n        <img  src=\"../assets/kefulogo.jpg\" :onerror=\"errorImgSrc\" alt=\"\">\n        <div>\n        <h3 @click=\"updataMapOverview\">加马——船帮帮客服工作平台</h3>\n        <p>Jiama Service</p>\n        </div>\n      </div>\n      <div class=\"nav-right\">\n        <img :src=\"userInfo.user_avatar\" :onerror=\"errorImgSrc\" alt=\"\">\n        <div>\n        <p>{{userInfo.user_name}}</p>\n        </div>\n        <button @click=\"dialogVisibleOff=true\"  v-if=\"status=='0'\">下班退出 <i class=\"iconfont icon-shangxiaban-copy\"></i> </button>\n        <button @click=\"dialogVisiblereadyOff=true\" v-else-if=\"status=='1'\">准备下班 <i class=\"iconfont icon-shangxiaban-copy\"></i> </button>\n        <button @click=\"dialogVisibleConfirm=true\" v-else-if=\"status=='2'\">准备下班 <i class=\"iconfont icon-shangxiaban-copy\"></i> </button>\n      </div>\n    </div>\n     <!-- 确认下班 dialog-->\n        <el-dialog\n          :visible.sync=\"dialogVisibleOff\"\n          width=\"30%\"\n          center>\n          <div class=\"dialogVisibleOff\">\n            <div >\n              <i class=\"iconfont icon-guanbi\"></i>\n              <p class=\"guanbi-p\" style=\"color: #ff5f49;\">下班退出</p>\n            </div>\n\n            <p style=\"margin-top: 50px;margin-bottom: 20px;\">今天已经工作了</p>\n            <p  style=\"font-size: 20px; font-weight: bold; color: black;\">{}小时{}分钟{}秒</p>\n            <button class=\"Off-button\">\n              确认下班\n            </button>\n            <p style=\"font-size: 16px;color: #4ed7d1;\" @click=\"dialogVisibleOff=false\">\n              我点错了，继续努力\n            </p>\n\n          </div>\n        </el-dialog>\n        <!-- 咨询刮起确认下班 -->\n         <el-dialog\n          :visible.sync=\"dialogVisiblereadyOff\"\n          width=\"30%\"\n          center>\n          <div class=\"dialogVisibleOff\">\n            <div >\n              <i class=\"iconfont icon-guanbi\"></i>\n              <p class=\"guanbi-p\" style=\"color:#4cd1cc\">准备下班</p>\n            </div>\n\n            <p style=\"margin-top: 50px;margin-bottom: 20px;\">有效的消息能让我们的工作效率更加提高</p>\n            <p  >点击准备下班将不会再为您介入新的咨询用户</p>\n            <button class=\"Off-button\" style=\"background-color:#4ed7d1\">\n              确认\n            </button>\n            <p style=\"font-size: 16px;color: #4ed7d1;\" @click=\"dialogVisiblereadyOff=false\">\n              我点错了，继续努力\n            </p>\n\n          </div>\n        </el-dialog>\n        <!-- 准备下班 -->\n         <el-dialog\n          :visible.sync=\"dialogVisibleConfirm\"\n          width=\"30%\"\n          center>\n          <span>这是一段信息</span>\n        </el-dialog>\n         <!-- 准备下班 -->\n         <el-dialog\n          :visible.sync=\"dialogVisibleTransfer\"\n          width=\"760px\"\n          title='移交给'\n          center>\n          <div class=\"dialogTransfer\">\n            <div v-for=\"(item,index) in 5\" :key=\"index\">\n              <span>\n                <i class=\"iconfont icon-selected\" v-if=\"true\"></i>\n                <i class=\"iconfont icon-yuan\" v-if=\"false\"></i>\n              </span>\n              <img src=\"../assets/logo.png\" alt=\"\">\n              <p>界不界限</p>\n            </div>\n          </div>\n          <div  class=\"endOrder-button\">\n           <button @click=\"dialogVisibleEndOrder=false\">取消</button> <button>确认</button>\n         </div>\n        </el-dialog>\n        <!-- 导航结束 -->\n    <!-- inner start -->\n    <div class=\"inner\">\n      <!-- 左边侧栏开始 -->\n    <div class=\"inner-left\">\n      <el-tabs type=\"border-card\" style=\"width: 100%;\" >\n        <el-tab-pane :label=\"currentService\" >\n      <ul>\n        <li v-for=\"(item,idx) in innerLeftList\" :key = idx  @click=\"getMessageInfo(item,idx)\">\n          <div class=\"inner-left-li-list\"  :class=\"idx==index? 'messageListStyle' : ' '\">\n            <img :src=\"item.user_avatar\" alt=\"\">\n            <div>\n                <p >{{item.user_name}}</p>\n                <span>{{item.start_time | timeFormat}}</span>\n            </div>\n            <div class=\"tip\">9</div>\n          </div>\n        </li>\n      </ul>\n    </el-tab-pane>\n    <el-tab-pane label=\"已结束服务\">\n      <ul>\n        <li v-for=\"(item,endidx) in endOrderList\" :key = endidx @click=\"getEndMessageInfo(item,endidx)\">\n          <div class=\"inner-left-li-list\"  :class=\"endidx==endindex? 'messageListStyle' : ' '\" >\n            <img :src=\"item.user_avatar\" alt=\"\">\n            <div >\n                <p >{{item.user_name}}</p>\n                <span>5分钟前</span>\n            </div>\n            <div class=\"tip\">9</div>\n          </div>\n        </li>\n      </ul>\n      </el-tab-pane>\n      </el-tabs>\n    </div>\n    <!-- 左边侧栏结束 -->\n    <!-- 地图开始 -->\n    <div class=\"locationSign\">\n      位置: {全国}\n    </div>\n    <div id=\"container\">\n    </div>\n    <!-- 地图结束 -->\n    <!-- 结束咨询开始 end order -->\n     <el-dialog\n          class=\"endOrder\"\n          :visible.sync=\"dialogVisibleEndOrder\"\n          width=\"38%\"\n          title=\"结束咨询\"\n          center>\n         <div  class=\"endOrder-time\">\n          <div >\n            <p>咨询时间</p>\n            <p class=\"time bg\">2019年5月13日  12:36</p>\n          </div>\n          <div >\n            <p>结束时间</p>\n            <p class=\"time bg\">2019年5月13日  12:36</p>\n          </div>\n          <div >\n            <p>服务时长</p>\n            <p class=\"time\">1小时28分钟</p>\n          </div>\n         </div>\n         <!-- 地址 -->\n         <div  class=\"endOrder-adress\">\n           <p>咨询地址</p>\n           <div v-if=\"edit==0\" class=\"bg text\">上海市-普陀区-镇坪路389号</div>\n           <input v-else-if=\"edit==1\" class=\"bg\" type=\"text\" v-model=\"inputEndOrderAdress\">\n            <i class=\"iconfont icon-iconfront-\" @click=\"edit=1\"></i>\n         </div>\n          <!-- 问题描述 -->\n         <div  class=\"endOrder-desc\">\n           <p>咨询问题描述</p>\n          <el-input\n          type=\"textarea\" class=\"bg\"\n          :autosize=\"{ minRows: 5, maxRows: 20}\"\n          placeholder=\"请输入内容\"\n          v-model=\"textareaEndOrderDesc\">\n        </el-input>\n         </div>\n         <div  class=\"endOrder-button\">\n           <button @click=\"dialogVisibleEndOrder=false\">取消</button> <button @click=\"EndOrder\">确认</button>\n         </div>\n        </el-dialog>\n        <!--结束咨询结束  -->\n    <!-- 内容右侧核心功能开始 -->\n    <div class=\"inner-right\" v-show=\"innerRightVisible\">\n      <div class=\"inner-right-nav\">\n        <span class=\"inner-right-nav-span\">当前服务</span>\n        <div style=\"width:57%;overflow: hidden;\"> \n        <img v-for=\"(item,index) in innerRightOrderMember\" :key = \"index\" :src=\"item.headPic\" :onerror=\"errorImgSrc\" :title=\"item.nickName\">\n        </div>\n         <i class=\"iconfont icon-jiahao\"></i>\n        <p class=\"inner-right-nav-p\" @click='dialogVisibleEndOrder = true'>\n          结束咨询\n        </p>\n      </div>\n      <!-- socket 消息列表 -->\n      <div class=\"inner-right-content infinite-list-wrapper\" id=\"socketMessageList\" >\n        <ul id=\"socketMessageListUl\">\n          <li v-for=\"(item,index) in innerRightMessageInfo\" :key ='index'>\n              <!-- <p class=\"time tc font12\">16:40</p> -->\n              <div class=\"message-item flex\">\n                <img class=\"message-item-pic\" src=\"https://tva1.sinaimg.cn/crop.0.0.100.100.50/006tUcvcjw8f46cbqeihzj302s02sdfm.jpg\" alt=\"\" >\n                <div data-v-79408788=\"\" class=\"flex message-box\">\n                  <div>\n                    <div class=\"message-box-top\"><span class=\"name\">{{item.nickName}}</span> <span class=\"day\">{{item.start_time | timeFormat}}</span> </div>\n                    <div class=\"bubble_cont basi left\">\n                      <div class=\"card1\">\n                        <p class=\"puretext font14 c333 wordbreak\" style=\"height: auto;\">{{item.data}}</p>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n            </div>\n          </li>\n        </ul>\n      </div>\n      <!-- 消息列表结束 -->\n      <!-- 消息输入 -->\n      <div class=\"inner-right-input\">\n       <el-input\n       @keydown.enter.native=\"websocketsend(socketMessageText)\"\n          type=\"textarea\"\n          :autosize=\"{ minRows: 5, maxRows: 5}\"\n          placeholder=\"请输入聊天内容\"\n          v-model=\"socketMessageText\">\n        </el-input>\n        <div class=\"inner-right-input-buttom\">\n          <div class=\"inner-right-input-buttom-left\">\n            <!-- 常用语 -->\n            <el-popover\n              ref=\"popover5\"\n              placement=\"top\"\n              v-model=\"visible2\">\n              <div class=\"CommonWord\">\n                  <p class=\"CommonTitle\">常用话</p>\n                <ul>\n                  <li>\n                   <div class=\"content\">请共享位置或说出您现在的大概位置</div> <div class=\"send\">发送</div>\n                  </li>\n                  <li>\n                    <div class=\"content\">请共享位置或说出您现在的大概位置</div> <div class=\"send\">发送</div>\n                  </li>\n                  <li>\n                   <div class=\"content\">我可以帮您查路况，查地点，设置导航位置，没事唠嗑也行！也可以帮你查周围的停车、加油等服务点。</div> <div class=\"send\">发送</div>\n                  </li>\n                </ul>\n              </div>\n            </el-popover>\n            <div v-popover:popover5>常用语</div>\n            <!-- 常见问题 -->\n            <el-popover\n              ref=\"popover4\"\n              placement=\"top\"\n              v-model=\"visible3\">\n              <div class=\"CommonWord\">\n                <p class=\"CommonTitle\">常见问题</p>\n                <ul>\n                  <li>\n                   <div class=\"content\">\n                     <p>出现机油压力过低，可能那些不见有问题</p>\n                     <p>\n                     请共享位置或说出您现在的大概位置\n                     </p>\n                    </div>\n                    <div class=\"send\">\n                       发送\n                    </div>\n                  </li>\n                </ul>\n              </div>\n            </el-popover>\n            <div class=\"commonProblem\" v-popover:popover4>常见问题</div>\n          </div>\n          <div class=\"bottom-right\">\n            <div class=\"inner-right-input-buttom-right\">\n              <i class=\"iconfont icon-tupian\"></i>\n            <i class=\"iconfont icon-yanjizhushou-shangchuan_maikefeng\"> </i>\n            </div>\n            <div class=\"sendMessage button\" @click=\"websocketsend(socketMessageText)\" >发送</div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <!-- 右侧核心功能结束 -->\n    <!-- inner end -->\n    </div>\n  </div>\n</template>\n\n<script>\n// import Cmap from '@/assets/js/Map'\nimport {MP} from '@/assets/js/Map.js'\nimport {mapState} from 'vuex'\nimport * as types from '@/store/mutation-types'\nimport Api from '../assets/js/api'\nimport axios from 'axios'\nimport utils from '../assets/js/utils'\nexport default {\n  beforeRouteEnter (to, from, next) {\n    console.log(to.path)\n    let url = window.location.href.split('?')[1] || \"\"\n    //获取url参数 存到session\n    if(url&&url!==\"\"){\n      url.split('&').forEach(item=>{\n        let query = item.split('=')\n        sessionStorage.setItem(query[0],query[1])\n      })\n    }\n    next()\n  },\n  created(){\n    //socket  token\n    let _this = this\n    let timeStamp = Date.parse(new Date()) / 1000\n    //获得当前验签\n    function getSign(){\n        let util =   utils.gainPhone({\n            appKey: '7863228592',\n            timestamp: timeStamp,\n            accessToken:sessionStorage.getItem('accessToken'),\n            accountID:sessionStorage.getItem('accountID'),\n            })\n        return util\n    }\n    //添加头部\n    let headers = {\n      appKey: '7863228592',\n      timestamp: timeStamp,\n      accessToken:sessionStorage.getItem('accessToken'),\n      accountID:sessionStorage.getItem('accountID'),\n      sign: getSign()\n    }\n    //刷新msgtoken 并且开启长连接\n    axios({\n        url:'/invokMessage/account/refreshMsgToken',\n        method:'POST',\n        headers:headers,\n        data:{accountID:sessionStorage.getItem('accountID')}\n      }).then(res=>{\n        console.log(res)\n        _this.msgToken = res.data.RESULT.msgToken\n        initWebSocket()\n        function initWebSocket(){\n        //初始化websocket\n        //建立连接\n        _this.websocket = new WebSocket('wss://im-msg-weixin.jiama.online/wss')\n        //建立成功\n        _this.websocket.onopen = function (){ //连接成功事件\n        console.log('websocket success')\n          _this.websocket.send (JSON.stringify ({\n                opt: \"connect\",\n                accountID: _this.accountID,\n                msgToken: _this.msgToken,\n                timestamp: 1559568992,\n                lat: 31.01, //登陆时纬度\n                lon: 121.01 //登陆时经度\n          }))\n        // this.start()\n        }\n        //建立失败\n          _this.websocket.onerror = function(){ //连接失败事件\n          console.log(\"WebSocket连接发生错误\");\n          //  this.reconnect();\n          }\n          //接受信息\n          _this.websocket.onmessage = function (event){ //接收服务器推送的信息\n            //打印收到的服务器内容\n            let data = JSON.parse(event.data)\n            console.log(data)\n              start()\n            let List = []\n            List.push(data)\n            _this.updataPushMapOverview(List)\n            console.log(List)\n            _this.createTagMessage('欢迎登陆')\n            //收到服务器信息，心跳充值\n            // reset()\n          }\n        //连接关闭\n          _this.websocket.onclose = function (e){\n          console.log(e)\n          clearTimeout(_this.timeoutObj)\n          console.log(\"connection closed (\" + e.code + \")\");\n          //重连\n          // this.reconnect()\n          }\n      }\n      function reconnect(){//重新连接\n          if(_this.lockReconnect){\n            return\n          }\n          _this.lockReconnect = true\n          //如果没有连上会一直重连，设置延迟避免请求过多\n          _this.timeoutnum && clearTimeout(_this.timeoutnum);\n          _this.timeoutnum = setTimeout(function(){\n            //新连接\n            // that.initWebSocket();\n            _this.lockReconnect = false\n          },false)\n        }\n        function start(){//开启心跳\n        console.log('start  go')\n        let time = 0\n          _this.timeoutObj = setInterval(function(){\n            console.log(time+1)\n            //这里发送一个心跳，后端收到后，返回一个心跳消息\n            let timeStamps = Date.parse (new Date ()) / 1000;\n              _this.websocket.send(JSON.stringify ({\n                opt: 'heart',\n                accountID: _this.accountID,\n                msgToken: _this.msgToken,\n                timestamp: timeStamps,\n                isKF: 1,\n                gps: [{\n                  E: 121.30692,\n                  N: 31.16184,\n                  V: 0,\n                  D: - 1,\n                  A: 13,\n                  T: timeStamps\n                }]\n              }));\n          },10000)\n        }\n    }).catch(err=>{\n      console.log(err)\n    })\n    if(!sessionStorage.getItem(\"accountID\")){\n        this.$router.push('/login')\n    }\n    //获取个人信息\n    this.$store.dispatch(types.GET_KF_INFO,this.accountID)\n    .then(res=>{\n      this.userInfo = res\n    }).catch(err=>console.log(err))\n        console.log(this.userInfo)\n    //获取服务单列表\n    this.ListData0 = {\n      \"status\":\"0\",\n      \"accountID\":this.accountID\n    }\n     this.ListData1 ={\n        \"status\":\"1\",\n        \"accountID\":this.accountID\n    }\n    this.ListData2 ={\n        \"status\":\"2\",\n        \"accountID\":this.accountID\n    }\n    //获取地图上未被接单的列表\n    this.getPushListOrder(this.ListData0)\n    //获取已接单列表\n    this.getListOrder(this.ListData1)\n    //获取结束单列表\n    this.getEndOrderList(this.ListData2)\n  },\n  name: 'index',\n  props: {\n    msg: String\n  },\n  data() {\n    return {\n      errorImgSrc: 'this.src=\"' + require('../assets/ServiceLogo.png') + '\"',\n      orderhelp:require('../assets/orderhelp.jpg'),\n      orderSOS:require('../assets/orderSOS.jpg'),\n      currentO_id:\"\",\n      //客服个人信息\n      userInfo:{},\n      //工单推送信息\n      userPointLocationOrderInfo:[],\n      //右侧已推送工单列表\n      innerLeftList:[],\n      //获取左侧列表\n      ListData0:{},\n      ListData1:{},\n      ListData2 :{},\n      accountID:sessionStorage.getItem('accountID'),\n      accessToken:sessionStorage.getItem('accessToken'),\n      //右边长连接消息详情\n      innerRightMessageInfo:[],\n      //右边成员列表\n      innerRightOrderMember:[],\n      //当前服务\n      currentServiceNum:0,\n      currentService:\"当前服务(0)\",\n      //已结束服务单列表\n      endOrderList:[],\n      dialogVisibleTransfer:false,\n      edit:0,//是否编辑\n      inputEndOrderAdress:\"上海市-普陀区-镇坪路389号\",\n      textareaEndOrderDesc:\"请描述用户所咨询的问题\",\n      status: \"1\",\n      socketMessageText:\"\",\n      index:Number,\n      endindex:Number,\n      leftListActive:\"\",\n      visible2: false,\n      visible3: false,\n      innerRightVisible:false,\n      dialogVisibleOff:false,\n      dialogVisiblereadyOff:false,\n      dialogVisibleConfirm:false,\n      dialogVisibleEndOrder:false,\n      ak: 'G1ZqRQeFuAutcV5NYPiVvdaMNQ5tWpp9',\n      currentServiceInfo:{},//当前服务信息,\n      map:{},//地图\n      BMap:{},\n      Overlay:{},\n      Point:{},\n     // socket 部分\n     msgToken:'',\n     websocket:null,//建立的连接\n     lockReconnect:false,\n     timeout:2*1000,//30秒一次的心跳\n     timeoutObj:null,//心跳倒计时\n     serverTimeoutObj:null,//心跳倒计时\n     timeoutnum:null,//断开 重连倒计时\n     lastRunTime:Date.now(),//上次播放的时间\n    }\n  },\n\n  mounted(){\n    //渲染地图\n   var _this = this;\n    MP(_this.ak).then(BMap => {\n      //在此调用api\n      _this.BMap = BMap\n      _this.Overlay = new BMap.Overlay()\n      _this.map = new _this.BMap.Map(\"container\");    // \n      _this.map.centerAndZoom(new _this.BMap.Point(116.404, 39.915), 11);\n      // 创建初始点 目前是北京 应根据客服所选城市  只推客服所选城市里的orderlist\n      let userPoint = new _this.BMap.Point(116.328, 40.020)\n      //创建初始覆盖物\n      //开启滚轮缩放\n\n      _this.map.enableScrollWheelZoom(true);\n      // 添加平移缩放\n      // map.addControl(new BMap.NavigationControl({anchor: BMAP_ANCHOR_BOTTOM_LEFT}));\n      // 添加比例尺\n      _this.map.addControl(new _this.BMap.ScaleControl());\n      _this.map.centerAndZoom(userPoint,15);\n      // 添加缩略地图\n      console.log(_this.BMap)\n      _this.map.addControl(new _this.BMap.OverviewMapControl());\n    }).then(res=>{\n        _this.getPushListOrder(_this.ListData0)\n    })\n  },\n  methods:{\n    //第一次加载页面刷新覆盖物\n    updataMapOverview(list){\n      var _this = this;\n      let BMap = _this.BMap\n      console.log(_this.map)\n          //循环遍历增加页面推送工单\n          //创建页面自定义覆盖物原型方法\n          function picOverlay(point,data){\n            this._point = point;\n            this.data = data\n          }\n          \n          picOverlay.prototype = _this.Overlay\n          picOverlay.prototype.initialize = function(map){\n            this._map = map\n            let div = this._div = document.createElement('div');\n            div.style.position = 'absolute'\n            div.style.overflow = 'hidden'\n            div.style.fontSize = '12px'\n            div.style.textAlign = 'center'\n            div.style.cursor = 'pointer'\n            div.style.zIndex = BMap.Overlay.getZIndex(this._point.lat);\n            let p = this._p = document.createElement('p')\n            let img = this._img = document.createElement('img')\n            let tipImg = this._tipImg = document.createElement('img')\n            p.appendChild(document.createTextNode(this.data.nickName))\n            img.setAttribute('src',this.data.headPic)\n            tipImg.setAttribute('src',_this.orderhelp)\n            //设置图片样式\n            img.style.width ='30px'\n            img.style.height ='30px'\n            img.style.border = '2px solid #005ced'\n            img.style.boxShadow = '0px 0px 8px #005ced'\n            img.style.borderRadius = '50px'\n            //设置tip图片样式\n            tipImg.style.width ='118px'\n            tipImg.style.height ='65px'\n\n            div.appendChild(tipImg)\n            div.appendChild(img)\n            div.appendChild(p)\n            //增加点击事件创建服务单\n            let data = this.data\n            //抢单事件\n            div.onclick = function(e){\n                //客服抢单时获取用户信息\n                console.log(data)\n                console.log(_this.accountID)\n                let QD_Data = {\n                  \"orderID\" : data.orderID,\n                  \"accountID\" : _this.accountID\n                }\n                _this.$store.dispatch(types.UPDATE_ORDER,QD_Data).then(res=>{\n                 _this.openSuccess('抢单成功')\n                _this.getListOrder(_this.ListData1)\n                  div.remove(div)\n                // let info = {\n                //   \"accountID\":_this.accountID,\n                //   \"nickName\":_this.userInfo.user_name,\n                //   \"headPic\":'https://jma.oss-cn-hangzhou.aliyuncs.com/headers/default-boy.jpg',\n                //   \"lng\": data.lng,\n                //   \"lat\": data.lat,\n                //   \"userType\":\"2\",\n                //   \"channelID\":data.channelID,\n                //   \"orderID\":data.o_id\n                // }\n                //点击抢单时客服加入频道\n                // _this.$store.dispatch(types.JOIN_CHANNEL,info).then(res=>{\n                 \n                //   console.log('频道加入成功')\n                //   console.log(res)\n                // }).catch(err=>{\n                //   console.log(err)\n                //   _this.openError('抢单失败')\n                // })\n              }).catch(err=>{\n                console.log(err)\n                _this.openError('抢单失败')\n              })\n              //获取正在服务服务单列表\n            }\n            _this.map.getPanes().labelPane.appendChild(div);\n              return div\n            }\n            picOverlay.prototype.draw = function(){\n              let map = this._map;\n              let pixel = map.pointToOverlayPixel(this._point)\n              this._div.style.left = pixel.x + \"px\";\n              this._div.style.top  = pixel.y - 30 + \"px\";\n            }\n          //遍历用户\n\n          if(list&&list[0]&&list.length>=1){\n              for (let it of list) {\n                let location =  {lng:it.lng,lat:it.lat}\n                let myOverlay = new picOverlay(location,it)\n                _this.map.addOverlay(myOverlay)\n            }\n\n          }\n\n    },\n    // 增加 / 更新 / 刷新页面 覆盖物\n    updataPushMapOverview(list){\n      var _this = this;\n      let BMap = _this.BMap\n      console.log(BMap)\n          //循环遍历增加页面推送工单\n          //创建页面自定义覆盖物原型方法\n          function picOverlay(point,data){\n            this._point = point;\n            this.data = data\n          }\n          picOverlay.prototype = _this.Overlay\n          picOverlay.prototype.initialize = function(map){\n            this._map = map\n            let div = this._div = document.createElement('div');\n            div.style.position = 'absolute'\n            div.style.overflow = 'hidden'\n            div.style.fontSize = '12px'\n            div.style.textAlign = 'center'\n            div.style.cursor = 'pointer'\n            div.style.zIndex = BMap.Overlay.getZIndex(this._point.lat);\n            let p = this._p = document.createElement('p')\n            let img = this._img = document.createElement('img')\n            let tipImg = this._tipImg = document.createElement('img')\n            p.appendChild(document.createTextNode(this.data.msgObj.nickName))\n            img.setAttribute('src',this.data.msgObj.headPic)\n            tipImg.setAttribute('src',_this.orderhelp)\n            //设置图片样式\n            img.style.width ='30px'\n            img.style.height ='30px'\n            img.style.border = '2px solid #005ced'\n            img.style.boxShadow = '0px 0px 8px #005ced'\n            img.style.borderRadius = '50px'\n            //设置tip图片样式\n            tipImg.style.width ='118px'\n            tipImg.style.height ='65px'\n\n            div.appendChild(tipImg)\n            div.appendChild(img)\n            div.appendChild(p)\n            //增加点击事件创建服务单\n            let data = this.data\n            //抢单事件\n            div.onclick = function(e){\n                //客服抢单时获取用户信息\n                console.log(data)\n                console.log(_this.accountID)\n                let QD_Data = {\n                  \"orderID\" : data.orderID,\n                  \"accountID\" : _this.accountID\n                }\n                _this.$store.dispatch(types.UPDATE_ORDER,QD_Data).then(res=>{\n                 _this.openSuccess('抢单成功')\n                _this.getListOrder(_this.ListData1)\n                  div.remove(div)\n                // let info = {\n                //   \"accountID\":_this.accountID,\n                //   \"nickName\":_this.userInfo.user_name,\n                //   \"headPic\":'https://jma.oss-cn-hangzhou.aliyuncs.com/headers/default-boy.jpg',\n                //   \"lng\": data.lng,\n                //   \"lat\": data.lat,\n                //   \"userType\":\"2\",\n                //   \"channelID\":data.channelID,\n                //   \"orderID\":data.o_id\n                // }\n                //点击抢单时客服加入频道\n                // _this.$store.dispatch(types.JOIN_CHANNEL,info).then(res=>{\n                 \n                //   console.log('频道加入成功')\n                //   console.log(res)\n                // }).catch(err=>{\n                //   console.log(err)\n                //   _this.openError('抢单失败')\n                // })\n              }).catch(err=>{\n                console.log(err)\n                _this.openError('抢单失败')\n              })\n              //获取正在服务服务单列表\n            }\n            _this.map.getPanes().labelPane.appendChild(div);\n              return div\n            }\n            picOverlay.prototype.draw = function(){\n              let map = this._map;\n              let pixel = map.pointToOverlayPixel(this._point)\n              this._div.style.left = pixel.x + \"px\";\n              this._div.style.top  = pixel.y - 30 + \"px\";\n            }\n          //遍历用户\n          console.log(list)\n          if(list&&list[0].msgObj&&list.length>=1){\n              for (let it of list) {\n                let location = {lng:it.msgObj.lng,lat:it.msgObj.lat}\n                let myOverlay = new picOverlay(location,it)\n                _this.map.addOverlay(myOverlay)\n            }\n\n          }\n\n    },\n    getPushListOrder(data){ //推送服务单列表\n      let _this = this\n      this.$store.dispatch(types.LIST_PUSH_ORDER,data)\n      .then(res=>{\n          if(res.status==\"error\"){\n            _this.endOrderList = []\n          }else{\n            _this.userPointLocationOrderInfo = res\n            _this.updataMapOverview(_this.userPointLocationOrderInfo)\n            console.log(_this.userPointLocationOrderInfo)\n          }\n      }).catch(err=>{\n        console.log(err)\n      })\n    },\n    getEndOrderList(data){ //已结束服务单列表\n      console.log(123)\n      let _this = this\n      this.$store.dispatch(types.LIST_ORDER,data)\n      .then(res=>{\n          if(res.status==\"error\"){\n            _this.endOrderList = []\n          }else{\n            _this.endOrderList = res\n          }\n      }).catch(err=>{\n        console.log(err)\n      })\n    },\n    //消息列表滚动条事件\n    handleScroll(){\n      let scroll = document.getElementById('socketMessageList')\n      let height = document.getElementById('socketMessageListUl').offsetHeight\n      scroll.scrollTop = scroll.scrollHeight\n    },\n    //获取服务单列表\n    getListOrder(data){\n      let _this = this\n      this.$store.dispatch(types.LIST_ORDER,data)\n      .then(res=>{\n            //获取还未被抢单的列表\n            if(data.status==\"0\"){\n              console.log(res)\n              _this.userPointLocationOrderInfo = res\n            //获取已经被抢单的列表\n            }else if(data.status==\"1\"){\n              console.log(res)\n              if(res.status==\"error\"){\n                _this.innerLeftList = []\n              }else{\n                _this.innerLeftList = res\n                _this.currentServiceNum = _this.innerLeftList.length\n              }\n            }\n      }).catch(err=>{\n        console.log(err)\n      })\n    },\n    //客服加入频道\n    joinChannel(info){\n      this.$store.dispatch(types.JOIN_CHANNEL,info).then(res=>{\n        console.log('joinChannel')\n        console.log(res)\n      }).catch(err=>{\n        console.log(err)\n      })\n    },\n    //获取右侧消息详情\n    getMessageInfo(item,index){\n      let _that = this\n      this.currentServiceInfo = item\n      //创建并且初始化聊天窗口\n      this.index = index\n      _that.innerRightOrderMember = []\n      this.innerRightVisible = true\n      let data = {\n        \"orderID\":item.orderID,\n        \"accountID\": item.accountID,// 登录用户id\n        \"isInit\":\"1\"\n      }\n      //建立长连接\n      // this.initWebSocket()\n        _that.$store.dispatch(types.INIT_ORDER,data)\n        .then(res=>{\n          _that.innerRightOrderMember = res\n          console.log(res)\n        }).catch(err=>{\n          console.log(err)\n        })\n      console.log(item)\n      //获取聊天记录\n      _that.$store.dispatch(types.GET_CHAT_LOG,item.channelID)\n      .then(res=>{\n        console.log(res)\n      }).catch(err=>{\n        console.log(err)\n      })\n      _that.innerRightMessageInfo = []\n\n\n    },\n    //获取右侧已结束消息详情\n    getEndMessageInfo(item,index){\n      let _that = this\n      //创建并且初始化聊天窗口\n      _that.endindex = index\n      _that.innerRightOrderMember = []\n      _that.innerRightVisible = true\n      \n        _that.$store.dispatch(types.INIT_ORDER,item.orderID)\n        .then(res=>{\n          _that.innerRightOrderMember = res\n          console.log(res)\n        }).catch(err=>{\n          console.log(err)\n        })\n\n      //获取聊天记录\n      _that.$store.dispatch(types.GET_CHAT_LOG)\n      .then(res=>{\n        console.log(res)\n      }).catch(err=>{\n        console.log(err)\n      })\n      _that.innerRightMessageInfo = []\n\n\n    },\n    //长连接消息推送部分\n    createTagMessage(message){\n      // let UI = document.getElementById('socketMessageListUl')\n      // let p  = document.createElement('p')\n      // p.className = 'createTagP'\n      // p.appendChild(document.createTextNode(message))\n      // UI.appendChild(p)\n    },\n    websocketsend(msg){ //向服务器发送消息\n          //数据发送\n          let _this = this\n          console.log(msg)\n          this.socketMessageText = \"\"\n          this.websocket.send(msg)\n          setTimeout(()=>{\n            _this.handleScroll()\n          },0)\n    },\n    \n    EndOrder(){\n         let info = this.currentServiceInfo.o_id\n         let _this = this\n         console.log(info)\n        this.$store.dispatch(types.END_ORDER,info).then(res=>{\n          this.openSuccess('结单成功')\n          _this.innerLeftList =  _this.innerLeftList.filter((val)=>{\n             return val.o_id != info\n          })\n          _this.endOrderList.push(this.currentServiceInfo)\n          _this.currentServiceNum = _this.innerLeftList.length\n        }).catch(err=>{\n          console.log(err)\n          this.openError('结单失败')\n        })\n        _this.currentServiceNum = _this.innerLeftList.length\n        this.dialogVisibleEndOrder=false\n        this.innerRightVisible = false\n        \n    },\n    //错误提示\n    openError(err) {\n        this.$message.error(err);\n    },\n    //成功提示\n    openSuccess(success) {\n        this.$message({\n          message:success,\n          type:'success'\n        })\n    },\n    dialogOff(){\n      this.$confirm('确认关闭？')\n          .then(_ => {\n            done();\n          })\n          .catch(_ => {});\n    },\n    dialogreadyOff(){\n        this.$confirm('确认关闭？')\n          .then(_ => {\n            done();\n          })\n          .catch(_ => {});\n    },\n    dialogConfirm(){\n      this.$confirm('确认关闭？')\n          .then(_ => {\n            done();\n          })\n          .catch(_ => {});\n    },\n  //聊天样式绑定 自己的和他人的\n    messageStyle(i=0,style=0){\n      if(i===0){\n        if(style==0){\n          return `message-item-self`\n        }else if(style==1){\n          return `card1-self`\n        }\n      }else if(i===1){\n        if(style==0){\n          return `message-item`\n        }else if(style==1){\n          return `card1`\n        }\n      }\n    }\n\n  },\n  filters:{\n    timeFormat:function(v){\n       let time = Date.parse(new Date())\n      let diff = (time/1000)-v \n      let t = new Date(v*1000) //86400 504780\n      if(diff<300&&diff>60){\n       return parseInt(diff/60)+'分钟前'\n      }else{\n        return  t.toLocaleString()\n      }\n    }\n  },\n  computed:{\n    // ...mapState({\n    //   userinfo:state=>state.userinfo.mySelfInfo.accountID\n    // })\n  },\n  watch:{\n    currentServiceNum:function(v){\n      this.currentService=\"当前服务(\"+v+\")\"\n    },\n    innerLeftList:function(v){\n    }\n  }\n}\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style lang=\"less\" scoped>\n.socket_create_p{\n\n}\n.locationSign{\n  display: inline-block;\n  height: 40px;\n  font-size: 14px;\n  position: absolute;\n  top: 100px;\n  left: 280px;\n  color: white;\n  background-color: rgba(0,0,0,.4);\n  line-height: 40px;\n  border-radius: 8px;\n  padding: 0 10px;\n  z-index: 99999;\n}\n.wordbreak{\n    word-break: break-word;\n    max-width: 350px;\n}\n/deep/.el-message{\n      top: 100px !important;\n}\n/deep/.el-tabs__nav-wrap{\n    border: 1px solid #4acdc8;\n    border-radius: 5px;\n    margin: 5px;\n}\n/deep/ .el-tabs__content{\n    height: 600px;\n    overflow-y: auto;\n}\n/deep/ .el-tabs__nav{\n    width: 100%;\n    .el-tabs__item{\n      width: 51%;\n      text-align: center;\n      color:#4acdc8 !important;\n      background-color: white\n    }\n    .is-active{\n      background-color:#4acdc8 !important;\n      color: white !important\n    }\n}\n.dialogTransfer{\n    display: flex;\n    flex-wrap: wrap;\n    margin-bottom: 200px;\n    .select{\n     color: #4ed7d1;\n    }\n    i{\n      font-size: 20px;\n      position: absolute;\n      right: 10px;\n      top: 5px;\n    }\n  img{\n    margin-top: 30px;\n    padding: 10px;\n    width: 40px;\n    height: 40px;\n  }\n  div{\n    position: relative;\n    width:124px ;\n    height:140px ;\n    text-align: center;\n    margin: 10px 18px 0 0;\n    box-shadow: 0px 1px 6px gainsboro;\n  }\n}\n.endOrder-button{\n  cursor: pointer;\n  text-align: right;\n  button{\n        cursor: pointer;\n    width: 80px;\n    height: 30px;\n    border-radius: 5px;\n    border-width: 0;\n    margin-left: 12px;\n  }\n  button:nth-of-type(1){\n    background-color: #f1f3f8\n  }\n  button:nth-of-type(2){\n    background-color: #4ed7d1;\n    color: white\n  }\n}\n#socketMessageList{\n    .message-item-self{\n        margin: 5px 0px 20px 15px;\n        flex-direction: row-reverse;\n    }\n  \n    .message-item{\n          margin: 5px 0px 20px 15px;\n    }\n        .card1{\n          background-color: #4992f7;\n          padding: 14px;\n          margin-top: 8px;\n          color: white;\n          font-size: 14px;\n          border-radius: 0px 8px 8px 8px;\n        }\n        .card1-self{\n            border-radius: 8px 0px 8px 8px;\n            background-color: #4992f7;\n            padding: 14px;\n            margin-top: 8px;\n            color: white;\n            font-size: 14px;\n        }\n        .message-box-top{\n          span{\n            padding-right: 10px;\n            font-size: 12px;\n          }\n          .day{\n            color:#aaaaaa\n          }\n          .time{\n            color:#aaaaaa\n          }\n        }\n        .message-item-pic{\n            padding: 8px;\n            width: 40px;\n            height: 40px;\n        }\n\n}\n.flex{\n  display: flex;\n}\n.endOrder{\n   .bg{\n    background-color: rgba(0,0,0,.05);\n  }\n  .endOrder-time{\n  display: flex;\n  justify-content: space-between;\n  .time{\n    width: 210px;\n    padding: 5px;\n    margin: 5px 20px 14px 0;\n  }\n \n}\n.endOrder-desc{\n  .el-textarea{\n    margin: 12px 0;\n   /deep/ .el-textarea__inner{\n      background-color: rgba(0,0,0,.01);\n    }\n  }\n}\n.endOrder-adress{\n      position: relative;\n    input{\n    border-width: 0px;\n    width: 100%;\n    padding: 5px 0;\n    margin: 10px 0;\n    }\n    .text{\n       width: 100%;\n      padding: 5px 0;\n      margin: 10px 0;\n    }\n    i{\n      position: absolute;\n      right: 0;    \n      top: 26px;\n      font-size: 20px;\n    }\n}\n}\n#container{\n    width: 100%;\n    height: 100%;\n    position: absolute;\n  }\n.dialogVisibleOff{\n  text-align: center;\n  .icon-guanbi{\n    font-size: 50px;\n\n  }\n  .guanbi-p{\n    padding-top: 10px;\n    font-size: 18px;\n    color: #ff5f49;\n  }\n  .Off-button{\n        cursor: pointer;\n    width: 70%;\n    height: 35px;\n    border-radius: 5px;\n    background-color: #ff5f49;\n    color: white;\n    font-size: 16px;\n    margin-top: 30px;\n    margin-bottom: 25px;\n  }\n}\n.el-popover{\n        width: 526px;\n  .CommonWord{\n    width: 400px;\n    .CommonTitle{\n      font-weight: bold;\n    text-align: center;\n    padding: 5px;\n    border-bottom: 1px solid #eeeeee;\n    }\n    div{\n          display: inline-block;\n    }\n    .content{\n              padding: 10px;\n              width: 83%;\n    }\n    .send{\n          cursor: pointer;\n        width: 10%;\n        height: 100%;\n        background-color: #4ed7d1;\n        color: white;\n        border-radius: 5px;\n        text-align: center;\n        padding: 5px 2px;\n    }\n\n  }\n}\n\n.nav-bar{\n    width: 100%;\n    display: flex;\n    justify-content: space-between;\n    position: fixed;\n    background: white;\n    z-index: 2;\n    box-shadow: 0px 1px 6px rgb(124, 106, 106);\n    .nav-left{\n          display: flex;\n          padding-left: 15px;\n          h3{\n            margin-top: 15px;\n            font-size:24px\n          }\n          img{\n              width: 70px;\n              height: 70px;\n          }\n    }\n    .nav-right{\n          margin-top: 5px;\n          display: flex;\n          img{\n              width: 60px;\n              height: 60px;\n              margin-right: 5px;\n              border-radius: 50px;\n          }\n          p{\n                margin-top: 15px;\n          }\n          button{\n               cursor: pointer;\n                margin: 10px;\n                width: 104px;\n                height: 38px;\n                border-radius: 8px;\n                background-color: #4ed7d1;\n                color: white;\n                font-size: 14px;\n                font-weight: 900;\n          }\n    }\n}\n.inner{\n      background-color: gainsboro;\n  .inner-left{\n        position: fixed;\n        z-index: 1;\n        width: 250px;\n        padding-top: 100px;\n        background-color: white;\n        box-shadow: 0px 1px 6px gainsboro;\n        .inner-left-top{\n              padding-left: 12px;\n              display: flex;\n              justify-content: space-between;\n              padding-bottom: 15px;\n              padding-right: 10px;\n              span:nth-of-type(1){\n                color:#888888\n              }\n        }\n        .inner-left-li-list{\n              position: relative;\n              display: flex;\n              margin: 5px 10px;\n              padding: 10px 10px;\n              border-bottom: 1px solid #dddddd;\n              .tip{\n                    position: absolute;\n                    background-color: #fa474f;\n                    font-size: 10px;\n                    height: 15px;\n                    padding: 0 3px;\n                    line-height: 13px;\n                    border-radius: 50%;\n                    color: white;\n                    right: 10px;\n                    bottom: 35px;\n              }\n              div>p{\n                    padding-bottom: 6px;\n              }\n            div>span{\n                  opacity: .7;\n                  font-size: 13px;\n            }\n        }\n        img{\n            width: 40px;\n            height: 40px;\n            margin-right: 7px;\n            border-radius: 50px;\n\n        }\n  }\n  .inner-right{\n        width: 500px;\n        height: auto;\n        background-color: white;\n        border-radius: 8px;\n        position: fixed;\n        right: 0;\n        margin-top: 80px;\n        box-shadow: 0px 1px 6px gainsboro;\n        .inner-right-nav{\n          display: flex;\n          padding: 15px;\n          justify-content: space-between;\n          border-bottom: 2px solid gainsboro;\n          .inner-right-nav-span{\n                padding-top: 8px;\n                color: #888888;\n          }\n          .inner-right-nav-p{\n                cursor: pointer;\n                border-left: 1px solid gainsboro;\n                padding-left: 8px;\n                margin-left: 10px;\n                color: #fa474f;\n                height: 25px;\n                padding-top: 8px;\n          }\n          img{\n              margin-left: 5px;\n              border-radius: 50px;\n              width: 40px;\n              height: 40px;\n          }\n          .icon-jiahao{\n            font-size: 37px;\n            color: gainsboro;\n          }\n        }\n        .inner-right-content{\n              height: 500px;\n              overflow-y: auto;\n              background-color: white;\n        }\n        /deep/ .el-textarea__inner{\n                border: 1px solid white;\n        }\n        .inner-right-input{\n          border-top: 1px solid gainsboro;\n          padding: 10px;\n          .inner-right-input-buttom{\n            background-color: white;\n            padding-bottom: 5px;\n            display: flex;\n            justify-content: space-between;\n            .bottom-right{\n             display: flex;\n            }\n            .inner-right-input-buttom-left div{\n                  cursor: pointer;\n                  width: 90px;\n                  height: 30px;\n                  text-align: center;\n                  background-color: #f1f3f8;\n                  line-height: 30px;\n                  border-radius: 5px;\n                  margin-left: 10px;\n              }\n               .inner-right-input-buttom-right {\n                  i{\n                    color: gainsboro;\n                    font-size: 36px;\n                    margin-right: 18px;\n                  }\n\n               }\n               .button{\n                     cursor: pointer;\n                        width: 100px;\n                        height: 35px;\n                        background-color: #4ed7d1;\n                        color: white;\n                        border-radius: 8px;\n                        text-align: center;\n                        line-height: 35px;\n                  }\n            div{\n              display: inline-block;\n            }\n          }\n        }\n  }\n}\n.messageListStyle{\n    background: linear-gradient(to right,#52dfd9,#4acdc8);\n    color:white !important;\n    border-radius: 10px;\n\n}\n</style>\n"]}]}